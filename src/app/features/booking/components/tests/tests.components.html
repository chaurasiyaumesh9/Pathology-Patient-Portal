<div class="container">
    <!-- Page Header -->
    <div class="mb-4">
        <h2 class="mb-2">Select Services</h2>
        <p class="text-muted">
            We offer a wide range of clinical laboratory services for early detection,
            screening, diagnosis, and monitoring across all age groups.
        </p>
    </div>

    <!-- Services Grid -->
    @if (tests$ | async; as tests) {
    <div class="row g-3">
        @for (test of tests; track test.id) {
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
            <div class="card h-100">
                <div class="card-body d-flex flex-column">
                    <!-- Service Name -->
                    <h6 class="card-title mb-2">
                        {{ test.name }}
                    </h6>

                    <!-- Price -->
                    <div class="text-muted mb-3">
                        ₹{{ test.discounted_price || test.original_price }}
                    </div>

                    <!-- Action Button -->
                    <div class="mt-auto text-end">
                        @if (!isSelected(test.id)) {
                        <button class="btn btn-sm btn-primary" (click)="addTest(test)">
                            Add
                        </button>
                        } @else {
                        <button class="btn btn-sm btn-outline-secondary" (click)="removeTest(test.id)">
                            Remove
                        </button>
                        }
                    </div>
                </div>
            </div>
        </div>
        }
    </div>

    <!-- Sticky Cart CTA -->
    @if (selectedTestsCount().length > 0) {
    <div class="border-top mt-4 pt-3 bg-white sticky-bottom">
        <div class="container d-flex justify-content-between align-items-center">
            <strong>
                {{ selectedTestsCount().length }} service(s) selected
            </strong>

            <a class="btn btn-outline-primary" routerLink="/booking/cart">
                View Cart →
            </a>
        </div>
    </div>
    }
    } @else {
    <div class="text-center my-5">
        <div class="spinner-border text-primary" role="status"></div>
    </div>
    }
</div>